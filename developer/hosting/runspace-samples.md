---
title: Runspace 샘플 | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c92a6d3d-8d34-4a76-bdc3-dea923d9858e
caps.latest.revision: 17
ms.openlocfilehash: e24d40746da91f60aaf2af655ddcadc88ab6a4db
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/23/2019
ms.locfileid: "62082739"
---
# <a name="runspace-samples"></a><span data-ttu-id="4b961-102">Runspace 샘플</span><span class="sxs-lookup"><span data-stu-id="4b961-102">Runspace Samples</span></span>

<span data-ttu-id="4b961-103">이 섹션에서는 다양 한 runspace 사용 하 여 동기적 및 비동기적으로 명령을 실행 하는 방법을 보여 주는 샘플 코드를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-103">This section includes sample code that shows how to use different types of runspaces to run commands synchronously and asynchronously.</span></span> <span data-ttu-id="4b961-104">콘솔 응용 프로그램을 만들고 다음 호스트 응용 프로그램에이 섹션의 항목에서 코드를 복사 하려면 Microsoft Visual Studio를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-104">You can use Microsoft Visual Studio to create a console application and then copy the code from the topics in this section into your host application.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="4b961-105">이 섹션의 내용</span><span class="sxs-lookup"><span data-stu-id="4b961-105">In This Section</span></span>

> [!NOTE]
> <span data-ttu-id="4b961-106">사용자 지정 호스트 인터페이스를 만드는 호스트 응용 프로그램의 샘플을 보려면 [사용자 지정 호스트 샘플](./custom-host-samples.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-106">For samples of host applications that create custom host interfaces, see [Custom Host Samples](./custom-host-samples.md).</span></span>

 <span data-ttu-id="4b961-107">[Runspace01 샘플](./runspace01-sample.md) 사용 하는 방법을이 보여 줍니다 합니다 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 실행 하는 클래스를 [Get-process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet 동기적으로 고 해당 출력을 콘솔에 표시 창입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-107">[Runspace01 Sample](./runspace01-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet synchronously and display its output in a console window.</span></span>

 <span data-ttu-id="4b961-108">[Runspace02 샘플](./runspace02-sample.md) 이 샘플에 사용 하는 방법을 보여 줍니다 합니다 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 실행 하는 클래스를 [Get-process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) 하 고 [Sort-object](/powershell/module/Microsoft.PowerShell.Utility/Sort-Object) cmdlet 동기적으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-108">[Runspace02 Sample](./runspace02-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) and [Sort-Object](/powershell/module/Microsoft.PowerShell.Utility/Sort-Object) cmdlets synchronously.</span></span> <span data-ttu-id="4b961-109">이러한 명령의 결과 사용 하 여 표시 되는 [System.Windows.Forms.Datagridview](/dotnet/api/System.Windows.Forms.DataGridView) 제어 합니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-109">The results of these commands is displayed by using a [System.Windows.Forms.Datagridview](/dotnet/api/System.Windows.Forms.DataGridView) control.</span></span>

 <span data-ttu-id="4b961-110">[Runspace03 샘플](./runspace03-sample.md) 사용 하는 방법을이 보여 줍니다 합니다 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 동기적으로 스크립트를 실행 하는 클래스 및 종료 되지 않는 오류를 처리 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-110">[Runspace03 Sample](./runspace03-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run a script synchronously, and how to handle non-terminating errors.</span></span> <span data-ttu-id="4b961-111">스크립트는 프로세스 이름 목록을 받은 다음 해당 프로세스를 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-111">The script receives a list of process names and then retrieves those processes.</span></span> <span data-ttu-id="4b961-112">스크립트를 실행할 때 생성된 종료되지 않는 오류를 포함하여 스크립트의 결과가 콘솔 창에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-112">The results of the script, including any non-terminating errors that were generated when running the script, are displayed in a console window.</span></span>

 <span data-ttu-id="4b961-113">[Runspace04 샘플](./runspace04-sample.md) 사용 하는 방법을이 보여 줍니다 합니다 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 명령을 실행 하는 클래스 및 명령을 실행 하는 경우 throw 되는 종료 오류를 catch 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-113">[Runspace04 Sample](./runspace04-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run commands, and how to catch terminating errors that are thrown when running the commands.</span></span> <span data-ttu-id="4b961-114">두 개의 명령이 실행되는데, 마지막 명령은 유효하지 않은 매개 변수 인수를 전달받습니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-114">Two commands are run, and the last command is passed a parameter argument that is not valid.</span></span> <span data-ttu-id="4b961-115">결과적으로 개체가 반환 되지 및 종료 오류가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-115">As a result no objects are returned and a terminating error is thrown.</span></span>

 <span data-ttu-id="4b961-116">[샘플 Runspace05](./runspace05-sample.md) 스냅인을 추가 하는 방법을이 보여 줍니다는 [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) runspace를 열 때 스냅인의 cmdlet을 사용할 수 있도록 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-116">[Runspace05 Sample](./runspace05-sample.md) This sample shows how to add a snap-in to an [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) object so that the cmdlet of the snap-in is available when the runspace is opened.</span></span> <span data-ttu-id="4b961-117">스냅인 Get-proc cmdlet을 제공 합니다 (정의한 합니다 [GetProcessSample01 샘플](../cmdlet/getprocesssample01-sample.md)) 사용 하 여 동기적으로 실행 되는 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-117">The snap-in provides a Get-Proc cmdlet (defined by the [GetProcessSample01 Sample](../cmdlet/getprocesssample01-sample.md)) that is run synchronously using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="4b961-118">[Runspace06 샘플](./runspace06-sample.md) 모듈을 추가 하는 방법을이 보여 줍니다는 [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) runspace를 열 때 모듈이 로드 되도록 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-118">[Runspace06 Sample](./runspace06-sample.md) This sample shows how to add a module to an [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) object so that the module is loaded when the runspace is opened.</span></span> <span data-ttu-id="4b961-119">모듈 제공 Get-proc cmdlet (정의한 합니다 [GetProcessSample02 샘플](../cmdlet/getprocesssample02-sample.md)) 사용 하 여 동기적으로 실행 되는 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-119">The module provides a Get-Proc cmdlet (defined by the [GetProcessSample02 Sample](../cmdlet/getprocesssample02-sample.md)) that is run synchronously using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="4b961-120">[샘플 Runspace07](./runspace07-sample.md) runspace를 만들고 해당 runspace를 사용 하 여 두 개의 cmdlet을 사용 하 여 동기적으로 실행 하는 방법을이 보여 줍니다는 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-120">[Runspace07 Sample](./runspace07-sample.md) This sample shows how to create a runspace, and then use that runspace to run two cmdlets synchronously by using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="4b961-121">[샘플 Runspace08](./runspace08-sample.md) 이 샘플의 파이프라인에 명령 및 인수를 추가 하는 방법을 보여 줍니다는 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 개체와 동기적으로 명령을 실행 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-121">[Runspace08 Sample](./runspace08-sample.md) This sample shows how to add commands and arguments to the pipeline of a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object and how to run the commands synchronously.</span></span>

 <span data-ttu-id="4b961-122">[샘플 Runspace09](./runspace09-sample.md) 이 샘플의 파이프라인에 스크립트를 추가 하는 방법을 보여 줍니다는 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 개체 및 스크립트를 비동기적으로 실행 하는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-122">[Runspace09 Sample](./runspace09-sample.md) This sample shows how to add a script to the pipeline of a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object and how to run the script asynchronously.</span></span> <span data-ttu-id="4b961-123">이벤트는 스크립트의 출력을 처리하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-123">Events are used to handle the output of the script.</span></span>

 <span data-ttu-id="4b961-124">[Runspace10 샘플](./runspace10-sample.md) 이 샘플에서는 기본 초기 세션 상태를 만드는 방법을 보여 줍니다. cmdlet을 추가 하는 방법을 합니다 [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState)를 사용 하는 runspace를 만드는 방법은 사용 하 여 명령을 실행 하는 방법과 초기 세션 상태를 [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) 개체입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-124">[Runspace10 Sample](./runspace10-sample.md) This sample shows how to create a default initial session state, how to add a cmdlet to the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState), how to create a runspace that uses the initial session state, and how to run the command by using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="4b961-125">[Runspace11 샘플](./runspace11-sample.md) 사용 하는 방법을 보여 줍니다 합니다 [System.Management.Automation.Proxycommand](/dotnet/api/System.Management.Automation.ProxyCommand) 기존 cmdlet을 호출 하지만 사용 가능한 매개 변수 집합을 제한 하는 프록시 명령을 만드는 클래스입니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-125">[Runspace11 Sample](./runspace11-sample.md) This shows how to use the [System.Management.Automation.Proxycommand](/dotnet/api/System.Management.Automation.ProxyCommand) class to create a proxy command that calls an existing cmdlet, but restricts the set of available parameters.</span></span> <span data-ttu-id="4b961-126">프록시 명령은 제한된 runspace를 만드는 데 사용되는 초기 세션 상태에 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-126">The proxy command is then added to an initial session state that is used to create a constrained runspace.</span></span> <span data-ttu-id="4b961-127">따라서 사용자가 프록시 명령을 통해서만 cmdlet의 기능에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4b961-127">This means that the user can access the functionality of the cmdlet only through the proxy command.</span></span>

## <a name="see-also"></a><span data-ttu-id="4b961-128">참고 항목</span><span class="sxs-lookup"><span data-stu-id="4b961-128">See Also</span></span>
